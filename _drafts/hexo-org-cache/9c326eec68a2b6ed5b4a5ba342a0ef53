{"md5":"6b109037817263fc3c624c9e50f4548c","content":"\n\n\n<div id=\"outline-container-sec-1\" class=\"outline-2\">\n<h2 id=\"sec-1\">&#x6982;&#x8FF0;</h2>\n<div class=\"outline-text-2\" id=\"text-1\">\n<p>\n&#x73B0;&#x6709; 3 &#x4E2A;&#x8282;&#x70B9; (NodeManager), &#x5047;&#x8BBE;&#x4E3A; host1, host2, host3. &#x9700;&#x8981;&#x5C06; 3 &#x4E2A;&#x8282;&#x70B9;&#x5212;&#x5206;&#x72EC;&#x7ACB;&#x7684;&#x961F;&#x5217;\n</p>\n</div>\n</div>\n\n<div id=\"outline-container-sec-2\" class=\"outline-2\">\n<h2 id=\"sec-2\">&#x914D;&#x7F6E;</h2>\n<div class=\"outline-text-2\" id=\"text-2\">\n</div><ul class=\"org-ul\"><li><a id=\"sec-2-0-0-1\" name=\"sec-2-0-0-1\"></a>&#x524D;&#x7F6E;&#x51C6;&#x5907;<br><div class=\"outline-text-5\" id=\"text-2-0-0-1\">\n<ul class=\"org-ul\">\n<li>&#x4F7F;&#x7528; capacity scheduler &#x8C03;&#x5EA6;&#x7B56;&#x7565;\n</li>\n</ul>\n<p>\n&#x5728; yarn-site.xml &#x4E2D;&#x6DFB;&#x52A0;\n</p>\n<div class=\"org-src-container\">\n\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"title\">property</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"title\">name</span>&gt;</span>yarn.resourcemanager.scheduler.class<span class=\"tag\">&lt;/<span class=\"title\">name</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"title\">value</span>&gt;</span>org.apache.hadoop.yarn.server.resourcemanager.scheduler.capacity.CapacityScheduler<span class=\"tag\">&lt;/<span class=\"title\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"title\">property</span>&gt;</span></span><br></pre></td></tr></table></figure>\n</div>\n<p>\n&#x6CE8;: &#x76EE;&#x524D;&#x53EF;&#x7528;&#x7684;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#x6709; <a href=\"https://hadoop.apache.org/docs/r2.7.2/hadoop-yarn/hadoop-yarn-site/FairScheduler.html\">FairScheduler</a>&#x3001;<a href=\"https://hadoop.apache.org/docs/r2.7.2/hadoop-yarn/hadoop-yarn-site/CapacityScheduler.html\">CapacityScheduler</a> &#x548C; FIFOScheduler\n</p>\n<ul class=\"org-ul\">\n<li>&#x5F00;&#x542F; Node Labels\n</li>\n</ul>\n<p>\n&#x5728; yarn-site.xml &#x4E2D;&#x6DFB;&#x52A0;\n</p>\n<div class=\"org-src-container\">\n\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"title\">property</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"title\">name</span>&gt;</span>yarn.node-labels.enabled<span class=\"tag\">&lt;/<span class=\"title\">name</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"title\">value</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"title\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"title\">property</span>&gt;</span></span><br></pre></td></tr></table></figure>\n</div>\n<ul class=\"org-ul\">\n<li>&#x8BBE;&#x7F6E; Node Label &#x4FE1;&#x606F;&#x5B58;&#x50A8; HDFS &#x8DEF;&#x5F84;\n</li>\n<li>&#x521B;&#x5EFA; HDFS &#x8DEF;&#x5F84;\n</li>\n</ul>\n<div class=\"org-src-container\">\n\n<figure class=\"highlight zsh\"><table><tr><td class=\"code\"><pre><span class=\"line\">sudo su hdfs</span><br><span class=\"line\">hadoop fs -mkdir -p /yarn/node-labels</span><br><span class=\"line\">hadoop fs -chown -R yarn:yarn /yarn</span><br><span class=\"line\">hadoop fs -chmod -R <span class=\"number\">700</span> /yarn</span><br></pre></td></tr></table></figure>\n</div>\n<ol class=\"org-ol\">\n<li>&#x5728; yarn-site.xml &#x4E2D;&#x6DFB;&#x52A0;\n</li>\n</ol>\n<div class=\"org-src-container\">\n\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"title\">property</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"title\">name</span>&gt;</span>yarn.node-labels.fs-store.root-dir<span class=\"tag\">&lt;/<span class=\"title\">name</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"title\">value</span>&gt;</span>/system/yarn/node-labels<span class=\"tag\">&lt;/<span class=\"title\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"title\">property</span>&gt;</span></span><br></pre></td></tr></table></figure>\n</div>\n</div>\n</li>\n\n<li><a id=\"sec-2-0-0-2\" name=\"sec-2-0-0-2\"></a>&#x521B;&#x5EFA; Node Labels<br><div class=\"outline-text-5\" id=\"text-2-0-0-2\">\n<p>\n&#x521B;&#x5EFA; 3 &#x4E2A;&#x540D;&#x4E3A; label_a, label_b, label_c &#x7684; Node Labels\n</p>\n<div class=\"org-src-container\">\n\n<figure class=\"highlight zsh\"><table><tr><td class=\"code\"><pre><span class=\"line\">sudo su yarn</span><br><span class=\"line\">yarn rmadmin -addToClusterNodeLabels <span class=\"string\">&quot;label_a(exclusive=true),label_b(exclusive=true),label_c(exclusive=true)&quot;</span></span><br></pre></td></tr></table></figure>\n</div>\n<p>\n&#x6CE8;: exclusive &#x9ED8;&#x8BA4;&#x4E3A; true, true &#x8868;&#x793A;&#x5F53;&#x524D; partition &#x7A7A;&#x95F2;&#x7684;&#x8D44;&#x6E90;&#x4E0D;&#x53EF;&#x88AB; default partition &#x7684;&#x4EFB;&#x52A1;&#x4F7F;&#x7528;, false &#x5219;&#x53CD;&#x4E4B;\n</p>\n</div>\n</li>\n<li><a id=\"sec-2-0-0-3\" name=\"sec-2-0-0-3\"></a>&#x5C06;&#x8282;&#x70B9; (NodeManager) &#x4E0E; Node Labels &#x7ED1;&#x5B9A;<br><div class=\"outline-text-5\" id=\"text-2-0-0-3\">\n<div class=\"org-src-container\">\n\n<figure class=\"highlight zsh\"><table><tr><td class=\"code\"><pre><span class=\"line\">yarn rmadmin -replaceLabelsOnNode <span class=\"string\">&quot;host1=label_a host2=label_b host3=label_c&quot;</span></span><br></pre></td></tr></table></figure>\n</div>\n<p>\n&#x6B64;&#x5904;&#x53EA;&#x5C06;&#x8282;&#x70B9;&#x4E0E; label &#x7ED1;&#x5B9A;(&#x672A;&#x6307;&#x5B9A; NodeManager &#x7684;&#x7AEF;&#x53E3;), &#x82E5; host &#x4E0A;&#x5B58;&#x5728;&#x591A;&#x4E2A; NodeManager &#x8FDB;&#x7A0B;&#x5219;&#x5747;&#x7ED1;&#x5B9A;&#x540C;&#x4E00;&#x4E2A; label. &#x53E6;&#x5916;, &#x5355;&#x4E2A; Node &#x53EA;&#x80FD;&#x7ED1;&#x5B9A;&#x4E00;&#x4E2A; label, &#x5982;&#x679C;&#x6307;&#x5B9A;&#x4E86;&#x7AEF;&#x53E3;, &#x5219;&#x8FD9;&#x4E2A;&#x8282;&#x70B9;&#x53EA;&#x80FD;&#x7ED1;&#x5B9A;&#x8FD9;&#x4E00;&#x4E2A; label.\n</p>\n</div>\n</li>\n<li><a id=\"sec-2-0-0-4\" name=\"sec-2-0-0-4\"></a>&#x5C06; Queue(&#x961F;&#x5217;) &#x4E0E; Node Label &#x7ED1;&#x5B9A;<br><div class=\"outline-text-5\" id=\"text-2-0-0-4\">\n<p>\nQueue &#x4E0E; Node Label &#x662F;&#x76F8;&#x5BF9;&#x5E73;&#x884C;&#x7684;&#x6982;&#x5FF5;&#x3002;&#x5047;&#x8BBE;&#x6211;&#x4EEC;&#x521B;&#x5EFA;&#x7684; Queue &#x5206;&#x522B;&#x4E3A; queue_a&#x3001;queue_b&#x3001;queue_c&#xFF0C; Label &#x5206;&#x522B;&#x4E3A; label_a&#x3001;label_b&#x3001;Label_c&#x3002;&#x6BCF;&#x4E2A; label &#x662F;&#x4E00;&#x4E2A;&#x5355;&#x72EC;&#x7684; Partition&#xFF0C;&#x521D;&#x59CB;&#x5316;&#x96C6;&#x7FA4;&#x7684; root &#x961F;&#x5217;&#x5C5E;&#x4E8E; &lt;DEFAULT_PARTITION&gt;\n(DEFAULT_PARTITION &#x5728;&#x7CFB;&#x7EDF;&#x4E2D;&#x88AB;&#x8BA4;&#x4E3A;&#x662F; non-label&#xFF0C;&#x5373;&#x6CA1;&#x6709; label &#x5C5E;&#x6027;)&#x3002;queue &#x521B;&#x5EFA;&#x5B8C;&#x6210;&#x540E;&#xFF0C;&#x5219;&#x5728;&#x6BCF;&#x4E2A; partition &#x4E0B;&#x90FD;&#x6709;&#x8FD9; 3 &#x4E2A;&#x961F;&#x5217;&#xFF0C;&#x5982;&#x679C; queue_[a, b, c] &#x8981;&#x5206;&#x522B;&#x72EC;&#x5360; label_[a, b, c] &#x4E0B;&#x7684; node &#x8D44;&#x6E90;&#xFF0C;&#x7B49;&#x540C;&#x4E8E;:\n</p>\n<ol class=\"org-ol\">\n<li>queue_a &#x53EF;&#x8BBF;&#x95EE; 100% &#x7684; label_a &#x7684;&#x8D44;&#x6E90;&#xFF0C;0% &#x7684; label_b &#x7684;&#x8D44;&#x6E90;&#xFF0C;0% &#x7684; label_c &#x7684;&#x8D44;&#x6E90;\n</li>\n<li>queue_b &#x53EF;&#x8BBF;&#x95EE; 0% &#x7684; label_a &#x7684;&#x8D44;&#x6E90;&#xFF0C;100% &#x7684; label_b &#x7684;&#x8D44;&#x6E90;&#xFF0C;0% &#x7684; label_c &#x7684;&#x8D44;&#x6E90;\n</li>\n<li>queue_c &#x53EF;&#x8BBF;&#x95EE; 0% &#x7684; label_a &#x7684;&#x8D44;&#x6E90;&#xFF0C;0% &#x7684; lable_b &#x7684;&#x8D44;&#x6E90;&#xFF0C;100% &#x7684; label_c &#x7684;&#x8D44;&#x6E90;\n</li>\n</ol>\n</div>\n</li></ul>\n</div>\n"}
