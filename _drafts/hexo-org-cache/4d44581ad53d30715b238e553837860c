{"md5":"c082db3a05c8c089a9ae4a457a54dd54","content":"\n\n<p>\nYARN &#x4F5C;&#x4E3A; Hadoop &#x4E2D;&#x7684;&#x8D44;&#x6E90;&#x8C03;&#x5EA6;&#x5668;&#xFF0C;&#x9488;&#x5BF9;&#x79BB;&#x7EBF;&#x573A;&#x666F;&#x63D0;&#x4F9B;&#x4E30;&#x5BCC;&#x7684;&#x529F;&#x80FD;&#x652F;&#x6301;&#x3002;&#x672C;&#x6587;&#x4E3B;&#x8981;&#x8BA8;&#x8BBA; Node Label &#x7684;&#x5B9E;&#x7528;&#x4EE5;&#x53CA;&#x76F8;&#x5173;&#x7684;&#x6982;&#x5FF5;\n</p>\n\n<p>\n&#x4F5C;&#x4E3A;&#x8D44;&#x6E90;&#x8C03;&#x5EA6;&#x5668;&#xFF0C;YARN &#x63D0;&#x4F9B;&#x4E86;&#x4E24;&#x4E2A;&#x91CD;&#x8981;&#x7684;&#x6982;&#x5FF5; Queue&#xFF08;&#x961F;&#x5217;&#xFF09;&#x548C; Partition&#xFF08;&#x5206;&#x533A;&#xFF09;&#xFF0C;&#x4E24;&#x8005;&#x662F;&#x540C;&#x7EA7;&#x7684;&#x6982;&#x5FF5;&#x3002;&#x5E95;&#x5C42;&#x8282;&#x70B9;&#x8D44;&#x6E90;&#x6302;&#x8F7D;&#x5728; Partition &#x4E0B;&#xFF0C;Queue &#x53EF;&#x6839;&#x636E;&#x9700;&#x6C42;&#x8BBE;&#x7F6E;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x54EA;&#x4E2A; Partition &#x7684;&#x8D44;&#x6E90;&#x4EE5;&#x53CA;&#x53EF;&#x4F7F;&#x7528;&#x7684;&#x6BD4;&#x4F8B;&#x3002;YARN &#x542B;&#x6709;&#x4E00;&#x4E2A;&#x9ED8;&#x8BA4; Partition&#xFF0C;&#x540D;&#x4E3A; DEFAULT PARTITION&#xFF0C;&#x9ED8;&#x8BA4;&#x6240;&#x5728;&#x7684;&#x8282;&#x70B9;&#x5747;&#x6302;&#x8F7D;&#x5728;&#x6B64; Partition &#x4E0B;&#x3002;Queue &#x7684;&#x8BDD;&#xFF0C;&#x6709;&#x4E00;&#x4E2A;&#x6839;&#x961F;&#x5217;&#x53EB; root&#xFF0C;&#x6240;&#x6709;&#x65B0;&#x5EFA;&#x7684;&#x961F;&#x5217;&#x5747;&#x4E3A; root &#x7684;&#x5B50;&#x961F;&#x5217;&#xFF0C;&#x9ED8;&#x8BA4;&#x7684;&#x5B50;&#x961F;&#x5217;&#x540D;&#x4E3A; default&#x3002;&#x5F53;&#x63D0;&#x4EA4;&#x4EFB;&#x52A1;&#x4E0D;&#x6307;&#x5B9A;&#x961F;&#x5217;&#x4EE5;&#x53CA;&#x5206;&#x533A;&#x65F6;&#xFF0C;&#x9ED8;&#x8BA4;&#x6B64;&#x4EFB;&#x52A1;&#x8FD0;&#x884C;&#x5728; DEFAULT PARTITION &#x7684; root &#x7684;&#x5B50;&#x961F;&#x5217; default &#x4E0B;&#x3002;\n</p>\n<!-- more -->\n\n<p>\n&#x961F;&#x5217; root &#x5B50;&#x961F;&#x5217;&#x7684;&#x8D44;&#x6E90;&#x5212;&#x5206;&#x5747;&#x4F7F;&#x7528;&#x767E;&#x5206;&#x6BD4;&#xFF0C;&#x4E14;&#x6240;&#x6709;&#x5B50;&#x961F;&#x5217;&#x7684;&#x767E;&#x5206;&#x6BD4;&#x4E4B;&#x548C;&#x5FC5;&#x987B;&#x7B49;&#x4E8E; 100%&#xFF0C;&#x5047;&#x5982; root &#x6709; 3 &#x4E2A;&#x5B50;&#x961F;&#x5217;&#x5206;&#x522B;&#x4E3A; default&#x3001;a&#x3001;b, &#x5219;&#x6240;&#x5360;&#x8D44;&#x6E90;&#x767E;&#x5206;&#x6BD4;&#x53EF;&#x5212;&#x5206;&#x4E3A; default&#xFF08;20%&#xFF09;&#x3001;a&#xFF08;30%&#xFF09;&#x3001;b&#xFF08;50%&#xFF09;&#x3002;\n</p>\n\n<p>\n&#x6839;&#x636E;&#x524D;&#x9762;&#x7684;&#x4E86;&#x89E3;&#xFF0C;&#x73B0;&#x6709; 3 &#x4E2A;&#x8282;&#x70B9; (NodeManager)&#xFF0C;&#x5047;&#x8BBE;&#x4E3A; host1&#x3001;host2&#x3001;host3&#xFF0C;&#x9700;&#x8981;&#x4FDD;&#x8BC1;&#x63D0;&#x4F9B; 3 &#x4E2A;&#x961F;&#x5217;&#xFF0C;&#x4E14;&#x6BCF;&#x4E2A;&#x961F;&#x5217;&#x7684;&#x4EFB;&#x52A1;&#x53EA;&#x80FD;&#x8FD0;&#x884C;&#x5728;&#x5176;&#x4E2D;&#x7684; 1 &#x4E2A;&#x8282;&#x70B9;&#x4E0A;&#x3002;&#x4E0B;&#x9762;&#x6211;&#x4EEC;&#x6765;&#x770B;&#x4E00;&#x4E0B;&#x5177;&#x4F53;&#x7684;&#x64CD;&#x4F5C;&#x6B65;&#x9AA4;\n</p>\n\n<div id=\"outline-container-sec-1\" class=\"outline-2\">\n<h2 id=\"sec-1\">&#x524D;&#x7F6E;&#x51C6;&#x5907;</h2>\n<div class=\"outline-text-2\" id=\"text-1\">\n<ul class=\"org-ul\">\n<li>&#x4F7F;&#x7528; capacity scheduler &#x8C03;&#x5EA6;&#x7B56;&#x7565;\n</li>\n</ul>\n<p>\n&#x5728; yarn-site.xml &#x4E2D;&#x6DFB;&#x52A0;\n</p>\n<div class=\"org-src-container\">\n\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"title\">property</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"title\">name</span>&gt;</span>yarn.resourcemanager.scheduler.class<span class=\"tag\">&lt;/<span class=\"title\">name</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"title\">value</span>&gt;</span>org.apache.hadoop.yarn.server.resourcemanager.scheduler.capacity.CapacityScheduler<span class=\"tag\">&lt;/<span class=\"title\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"title\">property</span>&gt;</span></span><br></pre></td></tr></table></figure>\n</div>\n<p>\n&#x6CE8;: &#x76EE;&#x524D;&#x53EF;&#x7528;&#x7684;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#x6709; <a href=\"https://hadoop.apache.org/docs/r2.7.2/hadoop-yarn/hadoop-yarn-site/FairScheduler.html\">FairScheduler</a>&#x3001;<a href=\"https://hadoop.apache.org/docs/r2.7.2/hadoop-yarn/hadoop-yarn-site/CapacityScheduler.html\">CapacityScheduler</a> &#x548C; FIFOScheduler\n</p>\n<ul class=\"org-ul\">\n<li>&#x5F00;&#x542F; Node Labels\n</li>\n</ul>\n<p>\n&#x5728; yarn-site.xml &#x4E2D;&#x6DFB;&#x52A0;\n</p>\n<div class=\"org-src-container\">\n\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"title\">property</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"title\">name</span>&gt;</span>yarn.node-labels.enabled<span class=\"tag\">&lt;/<span class=\"title\">name</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"title\">value</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"title\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"title\">property</span>&gt;</span></span><br></pre></td></tr></table></figure>\n</div>\n<ul class=\"org-ul\">\n<li>&#x8BBE;&#x7F6E; Node Label &#x4FE1;&#x606F;&#x5B58;&#x50A8; HDFS &#x8DEF;&#x5F84;\n</li>\n</ul>\n<p>\n&#x521B;&#x5EFA; HDFS &#x8DEF;&#x5F84;\n</p>\n<div class=\"org-src-container\">\n\n<figure class=\"highlight zsh\"><table><tr><td class=\"code\"><pre><span class=\"line\">sudo su hdfs</span><br><span class=\"line\">hadoop fs -mkdir -p /yarn/node-labels</span><br><span class=\"line\">hadoop fs -chown -R yarn:yarn /yarn</span><br><span class=\"line\">hadoop fs -chmod -R <span class=\"number\">700</span> /yarn</span><br></pre></td></tr></table></figure>\n</div>\n<p>\n&#x5728; yarn-site.xml &#x4E2D;&#x6DFB;&#x52A0;\n</p>\n<div class=\"org-src-container\">\n\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"title\">property</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"title\">name</span>&gt;</span>yarn.node-labels.fs-store.root-dir<span class=\"tag\">&lt;/<span class=\"title\">name</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"title\">value</span>&gt;</span>/system/yarn/node-labels<span class=\"tag\">&lt;/<span class=\"title\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"title\">property</span>&gt;</span></span><br></pre></td></tr></table></figure>\n</div>\n</div>\n</div>\n\n<div id=\"outline-container-sec-2\" class=\"outline-2\">\n<h2 id=\"sec-2\">&#x521B;&#x5EFA; Node Labels</h2>\n<div class=\"outline-text-2\" id=\"text-2\">\n<p>\n&#x521B;&#x5EFA; 3 &#x4E2A;&#x540D;&#x4E3A; label_a, label_b, label_c &#x7684; Node Labels\n</p>\n<div class=\"org-src-container\">\n\n<figure class=\"highlight zsh\"><table><tr><td class=\"code\"><pre><span class=\"line\">sudo su yarn</span><br><span class=\"line\">yarn rmadmin -addToClusterNodeLabels <span class=\"string\">&quot;label_a(exclusive=true),label_b(exclusive=true),label_c(exclusive=true)&quot;</span></span><br></pre></td></tr></table></figure>\n</div>\n<p>\n&#x6CE8;: exclusive &#x9ED8;&#x8BA4;&#x4E3A; true, true &#x8868;&#x793A;&#x5F53;&#x524D; partition &#x7A7A;&#x95F2;&#x7684;&#x8D44;&#x6E90;&#x4E0D;&#x53EF;&#x88AB; default partition &#x7684;&#x4EFB;&#x52A1;&#x4F7F;&#x7528;, false &#x5219;&#x53CD;&#x4E4B;\n</p>\n</div>\n</div>\n<div id=\"outline-container-sec-3\" class=\"outline-2\">\n<h2 id=\"sec-3\">&#x5C06;&#x8282;&#x70B9; (NodeManager) &#x4E0E; Node Labels &#x7ED1;&#x5B9A;</h2>\n<div class=\"outline-text-2\" id=\"text-3\">\n<div class=\"org-src-container\">\n\n<figure class=\"highlight zsh\"><table><tr><td class=\"code\"><pre><span class=\"line\">yarn rmadmin -replaceLabelsOnNode <span class=\"string\">&quot;host1=label_a host2=label_b host3=label_c&quot;</span></span><br></pre></td></tr></table></figure>\n</div>\n<p>\n&#x6B64;&#x5904;&#x53EA;&#x5C06;&#x8282;&#x70B9;&#x4E0E; label &#x7ED1;&#x5B9A;(&#x672A;&#x6307;&#x5B9A; NodeManager &#x7684;&#x7AEF;&#x53E3;), &#x82E5; host &#x4E0A;&#x5B58;&#x5728;&#x591A;&#x4E2A; NodeManager &#x8FDB;&#x7A0B;&#x5219;&#x5747;&#x7ED1;&#x5B9A;&#x540C;&#x4E00;&#x4E2A; label. &#x53E6;&#x5916;, &#x5355;&#x4E2A; Node &#x53EA;&#x80FD;&#x7ED1;&#x5B9A;&#x4E00;&#x4E2A; label, &#x5982;&#x679C;&#x6307;&#x5B9A;&#x4E86;&#x7AEF;&#x53E3;, &#x5219;&#x8FD9;&#x4E2A;&#x8282;&#x70B9;&#x53EA;&#x80FD;&#x7ED1;&#x5B9A;&#x8FD9;&#x4E00;&#x4E2A; label.\n</p>\n</div>\n</div>\n"}
